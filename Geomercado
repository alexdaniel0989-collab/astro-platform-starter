<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .tab-active { border-bottom: 4px solid white; font-weight: 900; opacity: 1; }
        .hidden { display: none; }
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <header class="bg-emerald-600 text-white sticky top-0 z-50 shadow-xl">
        <div class="max-w-md mx-auto px-4 pt-6 pb-2">
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center gap-2">
                    <div class="bg-white text-emerald-600 p-2 rounded-lg shadow-inner">
                        <i class="fas fa-map-location-dot text-xl"></i>
                    </div>
                    <h1 class="text-2xl font-black tracking-tighter uppercase">GeoMercado</h1>
                </div>
                <span id="status-gps" class="text-[10px] bg-emerald-800 border border-emerald-400 px-2 py-1 rounded-full uppercase tracking-widest opacity-80">
                    <i class="fas fa-circle text-red-500 animate-pulse mr-1"></i> GPS Inactivo
                </span>
            </div>
            
            <nav class="flex justify-around">
                <button id="btn-comprador" onclick="switchMode('comprador')" class="pb-3 px-4 tab-active opacity-100 transition-all uppercase text-xs">
                    <i class="fas fa-search mr-1"></i> Buscar
                </button>
                <button id="btn-vendedor" onclick="switchMode('vendedor')" class="pb-3 px-4 opacity-60 transition-all uppercase text-xs">
                    <i class="fas fa-store mr-1"></i> Vender
                </button>
            </nav>
        </div>
    </header>

    <main class="max-w-md mx-auto p-4 pb-24">

        <div id="view-comprador">
            <div class="relative mb-8">
                <input type="text" id="search-input" placeholder="¿Qué necesitas encontrar?" 
                    class="w-full p-5 pl-12 rounded-2xl shadow-2xl border-none focus:ring-4 focus:ring-emerald-200 outline-none text-lg">
                <i class="fas fa-search absolute left-4 top-6 text-emerald-400"></i>
                <button onclick="handleSearch()" class="absolute right-3 top-2 bottom-2 bg-emerald-600 text-white px-5 rounded-xl hover:bg-emerald-700 active:scale-95 transition-all">
                    IR
                </button>
            </div>

            <div id="results-area" class="space-y-4">
                <p class="text-slate-400 text-xs font-bold uppercase tracking-widest px-2">Cerca de tu posición actual</p>
                <div class="glass-card p-5 rounded-3xl shadow-sm border border-white hover:shadow-xl transition-all cursor-pointer group">
                    <div class="flex justify-between items-start">
                        <span class="bg-blue-100 text-blue-700 text-[10px] font-black px-2 py-1 rounded-md uppercase">Actualizado hace 5 min</span>
                        <span class="text-emerald-600 font-bold text-sm bg-emerald-50 px-2 py-1 rounded-lg">A 200m</span>
                    </div>
                    <h3 class="text-xl font-black text-slate-800 mt-3 group-hover:text-emerald-600 transition-colors">Verdulería "El Profe"</h3>
                    <p class="text-slate-500 text-sm mt-1"><i class="fas fa-map-pin text-rose-500 mr-1"></i> Jr. Huallaga 450 (Esquina)</p>
                    <div class="mt-4 flex gap-2">
                        <span class="text-xs bg-slate-100 px-3 py-1 rounded-full font-bold text-slate-600 italic">"Tengo lechuga fresca de hoy"</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-vendedor" class="hidden">
            <div class="bg-white rounded-[2.5rem] p-8 shadow-2xl border border-emerald-100">
                <h2 class="text-2xl font-black text-slate-800 mb-2 leading-tight">Registra tu ubicación de venta</h2>
                <p class="text-slate-400 text-sm mb-8 font-medium">Ayuda a tus vecinos a encontrarte fácilmente.</p>

                <div class="space-y-6">
                    <div>
                        <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1">Nombre Comercial</label>
                        <input type="text" id="seller-name" placeholder="Ej. Puesto Doña Rosa" 
                            class="w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:border-emerald-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1">Producto Estrella</label>
                        <input type="text" id="seller-product" placeholder="Ej. Lechuga, Tomate, Papas..." 
                            class="w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:border-emerald-500 outline-none transition-all">
                    </div>
                    
                    <div id="gps-box" class="p-4 rounded-2xl bg-slate-50 border-2 border-dashed border-slate-200 flex items-center gap-4 transition-all">
                        <div id="gps-icon" class="w-12 h-12 bg-slate-200 rounded-xl flex items-center justify-center text-slate-400">
                            <i class="fas fa-location-crosshairs text-xl"></i>
                        </div>
                        <div>
                            <p id="gps-text" class="text-xs font-bold text-slate-400">GPS esperando señal...</p>
                        </div>
                    </div>

                    <button onclick="publishLocation()" id="btn-publish" class="w-full py-5 bg-emerald-600 text-white rounded-2xl font-black text-lg shadow-lg hover:bg-emerald-700 active:scale-[0.98] transition-all">
                        PUBLICAR MI PUESTO
                    </button>
                </div>
            </div>
        </div>

    </main>

    <script>
        // 1. Navegación de Pestañas
        function switchMode(mode) {
            const compView = document.getElementById('view-comprador');
            const vendView = document.getElementById('view-vendedor');
            const btnComp = document.getElementById('btn-comprador');
            const btnVend = document.getElementById('btn-vendedor');

            if(mode === 'comprador') {
                compView.classList.remove('hidden');
                vendView.classList.add('hidden');
                btnComp.classList.add('tab-active');
                btnVend.classList.remove('tab-active');
                btnComp.style.opacity = "1";
                btnVend.style.opacity = "0.6";
            } else {
                compView.classList.add('hidden');
                vendView.classList.remove('hidden');
                btnVend.classList.add('tab-active');
                btnComp.classList.remove('tab-active');
                btnVend.style.opacity = "1";
                btnComp.style.opacity = "0.6";
                startGPS(); // Activar GPS automáticamente al entrar a modo vendedor
            }
        }

        // 2. Lógica de Geolocalización Real
        let currentCoords = null;

        function startGPS() {
            const statusLabel = document.getElementById('status-gps');
            const gpsText = document.getElementById('gps-text');
            const gpsBox = document.getElementById('gps-box');
            const gpsIcon = document.getElementById('gps-icon');

            if (!navigator.geolocation) {
                gpsText.innerText = "GPS no soportado en este navegador.";
                return;
            }

            navigator.geolocation.getCurrentPosition((pos) => {
                currentCoords = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                
                // Actualizar Interfaz Profesional
                statusLabel.innerHTML = '<i class="fas fa-circle text-emerald-400 mr-1"></i> GPS Conectado';
                statusLabel.classList.add('bg-emerald-900');
                gpsText.innerHTML = `<span class="text-emerald-600">Ubicación capturada con éxito</span><br><span class="text-[10px] text-slate-400">Lat: ${currentCoords.lat.toFixed(4)} | Lng: ${currentCoords.lng.toFixed(4)}</span>`;
                gpsBox.classList.replace('bg-slate-50', 'bg-emerald-50');
                gpsBox.classList.replace('border-slate-200', 'border-emerald-200');
                gpsIcon.classList.replace('bg-slate-200', 'bg-emerald-600');
                gpsIcon.classList.replace('text-slate-400', 'text-white');
                
            }, (err) => {
                gpsText.innerText = "Error: Activa los permisos de ubicación.";
                console.error(err);
            });
        }

        // 3. Acción de Publicar (Simulada para Frontend)
        function publishLocation() {
            const name = document.getElementById('seller-name').value;
            const product = document.getElementById('seller-product').value;

            if(!name || !product || !currentCoords) {
                alert("Por favor, completa los datos y permite el acceso al GPS.");
                return;
            }

            alert(`¡LOGRADO!\nTu puesto "${name}" ahora es visible para los compradores en las coordenadas: ${currentCoords.lat}, ${currentCoords.lng}.\n\n(En la versión final, esto se guardará en tu servidor Firebase)`);
        }

        // 4. Acción de Búsqueda
        function handleSearch() {
            const query = document.getElementById('search-input').value;
            if(query) {
                alert(`Buscando "${query}" en el área...`);
            }
        }
    </script>
</body>
</html>
